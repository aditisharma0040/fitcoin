<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>
      log in
    </title>
    <link rel="stylesheet" href="reg_style.css">
  </head>
  <body style="margin-top: 0px;
  margin-right: 0px;
  margin-left: 0px;">
    <div id="login-page" class="login-block">
      <div class="part1">
        <p style="font-size: 35px;
        color:black;
        padding-left: 40px;
        margin-top: 0px;
        margin-bottom: 0px;">LOG IN</p>
        <input class="input_box" type="email" id="email" name="email" placeholder="E-mail"/>
        <input class="input_box" type="password" id="password" name="password" placeholder="password"/>
        <input  class="button-login" type="submit" id="login" name="login" value="login"/>
      </div>
      <div class="homepagediv"></div>
    </div>
    </body>
    <script type="module">
      // Import the functions you need from the SDKs you need
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
      import  { getDatabase, set, ref, update } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";
      import { getAuth, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
      // TODO: Add SDKs for Firebase products that you want to use
      // https://firebase.google.com/docs/web/setup#available-libraries
    
      // Your web app's Firebase configuration
      const firebaseConfig = {
        apiKey: "AIzaSyAn_m7r28H01CbYHXMngaUbSK4xYPYyiEY",
        authDomain: "fitcoinauth.firebaseapp.com",
        databaseURL: "https://fitcoinauth-default-rtdb.firebaseio.com",
        projectId: "fitcoinauth",
        storageBucket: "fitcoinauth.appspot.com",
        messagingSenderId: "521509993172",
        appId: "1:521509993172:web:1ab67024e7dcf884bc1941"
      };
    
      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const database = getDatabase(app);
      const auth = getAuth();
    login.addEventListener('click', (e)=>{
      var email = document.getElementById('email').value;
      var password = document.getElementById('password').value;

      signInWithEmailAndPassword(auth, email, password)
       .then((userCredential) => {
    // Signed in 
    const user = userCredential.user;

    /*const dt = new Data();
    update(ref(database, 'users/' + user.uid),{
        last_login: dt,
    })*/
    alert('user loged in!');
    const backtopage = document.querySelector('.homepagediv') ;
    if ( true) {
      backtopage.innerHTML= `<p>you have successfully loged in!!</p>
       <a href="Fitcoin copy.html">
        <button class="button-login">start investing</button>
      </a>`
      
    }
  
    // ...
  })
  .catch((error) => {
    const errorCode = error.code;
    const errorMessage = error.message;
    alert(errorMessage);
  });


    });

   
  const user = auth.currentUser;
  onAuthStateChanged(auth, (user) => {
  if (user) {
    // User is signed in, see docs for a list of available properties
    // https://firebase.google.com/docs/reference/js/auth.user
    const uid = user.uid;

    // ...
  } else {
    // User is signed out
    // ...
  }
});
logout.addEventListener('click',(e)=>{
  signOut(auth).then(() => {
    alert('user signed out')
  // Sign-out successful.
}).catch((error) => {
  const errorCode = error.code;
    const errorMessage = error.message;
    alert(errorMessage);
  // An error happened.
});

});
  
    </script>
    </html>